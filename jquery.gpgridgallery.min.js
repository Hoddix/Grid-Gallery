(function(e){var n=[];var r=[];var i=[];e.fn.galeria=function(s){function u(){o._content.css("position","relative").css("margin-top",o.margintop).css("margin-right",o.marginright).css("margin-bottom",o.marginbottom).css("margin-left",o.marginleft)}function a(e){var t,n,r,i=0,s=true,u=100;o.margintop=e.css("margin-top");o.marginright=e.css("margin-right");o.marginbottom=e.css("margin-bottom");o.marginleft=e.css("margin-left");if(o.marginleft.indexOf("%")!=-1){n=parseInt(o.marginleft.substr(0,o.marginleft.indexOf("%")));s=true;i=i+n}if(o.marginright.indexOf("%")!=-1){s=true;r=parseInt(o.marginright.substr(0,o.marginright.indexOf("%")));i=i+r}if(o.marginleft.indexOf("px")!=-1){s=false;n=parseInt(o.marginleft.substr(0,o.marginleft.indexOf("px")));i=i+n}if(o.marginright.indexOf("px")!=-1){s=false;r=parseInt(o.marginright.substr(0,o.marginright.indexOf("px")));i=i+r}if(!s){t=i}else{t=o._windowSizeW*i/100}o._contSize=o._windowSizeW-t;e.css("width",parseInt(o._contSize));o._contSize=Math.ceil(e[0].clientWidth);if(o._contSize%2!=0){o._contSize++;e.css("width",parseInt(o._contSize))}return o._contSize}function f(){var t,n,r,i,s;var u=0,a=false;o._l=0;o._imagesTemp=o._images;for(var l=0;l<o._imagesTemp.length;l++){if(o._resize){t=o._imagesTemp[l].clientWidth;n=o._imagesTemp[l].clientHeight;r=e(o._imagesTemp[l]).data("rest");t=t-parseInt(r)}else{t=o._imagesTemp[l].width;n=o._imagesTemp[l].height}t=t*o.maxheight/n;t=parseInt(t);n=o.maxheight;o._row=o._row+(t+o.imgmargin*2);u=o._contSize-o._row;i=o._l;s=o._t;o._imgsRow.push([o._imagesTemp[l],t,n,i,s]);o._l=o._l+(t+o.imgmargin*2);if(u>0&&u<10){o._match=true;o._t=o._t+(o.maxheight+o.imgmargin*2);break}else if(o._row>o._contSize){o.maxheight--;o._row=0;o._imgsRow=[];o._reboot=true;break}a=true}if(o._reboot){o._reboot=false;f()}else if(o._match){o._match=false;var p=o._imgsRow;for(var d=0;d<o._imgsRow.length;d++){o._imagesTemp.splice(0,1)}o._images=o._imagesTemp;o.maxheight=o.maxheight_def;o._row=0;o._imgsRow=[];if(o._resize){c(p,u)}else{h(p,u)}}else if(a){var p=o._imgsRow;a=false;for(var d=0;d<o._imgsRow.length;d++){o._imagesTemp.splice(0,1)}o._images=o._imagesTemp;o.maxheight=o.maxheight_def;o._row=0;o._imgsRow=[];if(o._resize){o._t=o._t+n;c(p,0)}else{h(p,0)}}}function c(n,r){var i="";var s=0;var u=0;var a=0;for(var c=0;c<n.length;c++){i=e(n[c][0]);s=n[c][1];u=n[c][2];l=n[c][3];t=n[c][4];a=0;if(c==0){a=r;s=n[c][1]+r}if(c==0){i.css("z-index","10").animate({left:0,top:t},{queue:false})}else{i.css("z-index","9").animate({left:l+r,top:t},{queue:false})}i.attr("data-rest",a).css("position","absolute").css("width",s).css("height",u);i.find("img").attr("width",s).attr("height",u)}if(o._imagesTemp.length!=0){f()}}function h(n,r){var i="";var s=0;var u=0;var a=0;for(var c=0;c<n.length;c++){i=o.directory+"/"+n[c][0].file;s=n[c][1];u=n[c][2];l=n[c][3];t=n[c][4];a=0;if(c==0){a=r;s=n[c][1]+r}else{l=l+r}var h=e('<div class="galery" data-rest="'+a+'"><img src="'+i+'" alt="" width="'+s+'" height="'+u+'"/></div>').css("position","absolute").css("top",t).css("left",l).css("margin",o.imgmargin+"px").css("cursor","pointer").css("width",s).css("height",u);if(o.fade){h.fadeIn(Math.random()*2e3)}o._img.push(h)}if(o._imagesTemp.length==0){o._print=true;o._t=0}else{f()}}function p(){var t=e(".panel-galery");var n=e(".bagro");if(t.length==0){var r=e('<div class="panel-galery"></div>');r.css("position","fixed").css("top","5%").css("background-color","white").css("display","none").css("border","1px solid black").css("z-index","99999").css("box-sizing","border-box").css("padding","20px").css("border-radius","10px").css("box-shadow","0px 0px 20px black");e("body").append(r)}if(n.length==0){var i=e('<div class="bagro"/>');i.css("position","fixed").css("height","100%").css("width","100%").css("background","rgba(0, 0, 0, 0.76)").css("z-index","99998").css("display","none").css("top","0").css("left","0");i.insertBefore(".panel-galery")}}var o=e.extend({directory:"album",maxheight:240,maxheight_def:240,imgmargin:1,_t:0,_l:0,_contSize:0,_window:e(window),_windowSizeW:0,_windowSizeH:0,_row:0,_images:[],_imagesTemp:[],_imgsRow:[],_elmt:[],_elements:[],_elmtRow:[],_reboot:false,_match:false,_resize:false,fade:true,_newSize:0,_img:[],_content:this,margintop:"0px",marginright:"0px",marginbottom:"0px",marginleft:"0px",_print:false},s);(function(){if(e(o._content).parent().is("body")){o._windowSizeW=window.innerWidth;o._windowSizeH=window.innerHeight}else{o._windowSizeW=e(o._content).parent()[0].clientWidth;o._windowSizeH=e(o._content).parent()[0].clientHeight}u();a(e(o._content))})();(function(){i.push(o.maxheight);n.push(e(o._content));r.push(o.imgmargin);jQuery.ajax({type:"POST",url:"read_dir.php",data:{dir:o.directory},success:function(e){o._images=e},dataType:"json",async:false})})();(function(){o.maxheight_def=o.maxheight;f();p()})();if(o._print){o._print=false;for(var d=0;d<o._img.length;d++){o._content.append(o._img[d])}e(o._content).css("height",o._content[0].scrollHeight)}e(window).on("resize",function(t){window.resizeEvt;e(window).resize(function(){clearTimeout(window.resizeEvt);window.resizeEvt=setTimeout(function(){for(var t=0;t<n.length;t++){o._images=[];if(e(n[t]).parent().is("body")){o._windowSizeW=window.innerWidth;o._windowSizeH=window.innerHeight}else{o._windowSizeW=e(n[t]).parent()[0].clientWidth;o._windowSizeH=e(n[t]).parent()[0].clientHeight}o.maxheight=i[t];o.maxheight_def=i[t];o.imgmargin=r[t];o._contSize=a(n[t]);o._images=n[t].find(".galery");o._resize=true;f();e(n[t]).css("height",o._t+10+"px");o._t=0;o._resize=false}},750)})})};e("body").on("mouseover",".galery",function(){e(this).animate({opacity:.5},{queue:false},"fast")});e("body").on("mouseout",".galery",function(){e(this).animate({opacity:1},{queue:false},"fast")});var s=navigator.userAgent;if(s.match(/iPhone/)||s.match(/iPad/)){event="touchstart"}else{event="click"}e("body").on(event,".galery",function(){var t=e(this).find("img");var n=t.attr("src");var r;var i;var s;var o=e('<span class="flop" id="cerrar">x</span>');o.css("position","absolute").css("right","2px").css("top","2px").css("background-color","rgba(128, 128, 128, 0.36)").css("width","20px").css("height","20px").css("cursor","pointer").css("text-align","center").css("border-radius","20px").css("text-decoration","none").css("font-family","Arial").css("color","white").css("z-index","1000000");var u=window.innerHeight;var a=window.innerWidth;var f=e(".panel-galery").css("top");f=f.substr(0,f.indexOf("%"));var l=parseInt(Math.ceil(u*5/100));u=u-l*3;var c=new Image;c.src=n;if(c.height>=u&&c.width<=a){r=c.width*u/c.height;i=u}else if(c.height<=u&&c.width>=a){i=(c.height*a-100)/c.width;r=a-100}else if(c.height>=u&&c.width>=a){a=a-100;r=a;i=c.height*a/c.width;while(i>u){i=c.height*a/c.width;a--}r=a}else{r=c.width;i=c.height}var t='<img src="'+n+'" width="'+parseInt(r)+'" height="'+parseInt(i)+'" alt="" />';s=parseInt(window.innerWidth-r);s=parseInt(Math.ceil(s/2)-20);e(".panel-galery").css("left",s);e(".panel-galery").html(t);e(".panel-galery").append(o);e(".panel-galery").fadeIn("fast");e(".bagro").fadeIn("slow")});e("body").on(event,".flop",function(){if(e(".panel-galery").is(":visible")){e(".panel-galery").fadeOut("fast");e(".bagro").fadeOut("slow")}});e(document).on(event,".bagro",function(){if(e(".panel-galery").is(":visible")){e(".panel-galery").fadeOut("fast");e(".bagro").fadeOut("slow")}});e(document).keyup(function(t){if(e(".panel-galery").is(":visible")){if(t.which===27){e(".panel-galery").fadeOut("fast");e(".bagro").fadeOut("slow")}}})})(jQuery)